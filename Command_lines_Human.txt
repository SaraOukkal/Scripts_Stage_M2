#Récupérer les alignements communs aux 4 espèces: 
##Créer les fichiers .bed de l'Homme:
python3 Human_bed.py -i /home/saraoukkal/Documents/Stage_M1/20200616_hg38_to_panTro5/ -o /home/saraoukkal/Documents/Stage_M1/Step1_results/20200728_HC.bed
python3 Human_bed.py -i /home/saraoukkal/Documents/Stage_M1/20200724_hg38_to_gorGor4/ -o /home/saraoukkal/Documents/Stage_M1/Step1_results/20200728_HG.bed 
python3 Human_bed.py -i /home/saraoukkal/Documents/Stage_M1/20200724_hg38_to_ponAbe2/ -o /home/saraoukkal/Documents/Stage_M1/Step1_results/20200728_HO.bed
##Calculer les intervalles de l'Homme qui s'alignet sur les 4 espèces: 
###J'ai du modifier le script Human_Bedtools_intersect à cause des pathways pour les fichiers (comment utiliser argparse dans un script bash) et changer les noms des outputs 
bash Human_Bedtools_intersect 
##Recalculer les intervalles de toutes les espèces: 
python3 New_intervals.py -sp1 /home/saraoukkal/Documents/Stage_M1/20200616_hg38_to_panTro5/ -sp2 /home/saraoukkal/Documents/Stage_M1/20200724_hg38_to_gorGor4/ -sp3 /home/saraoukkal/Documents/Stage_M1/20200724_hg38_to_ponAbe2/ -bed /home/saraoukkal/Documents/Stage_M1/Step1_results/HC_HG_HO_intersect_sorted.bed -o /home/saraoukkal/Documents/Stage_M1/Step1_results/new_intervals.txt

#Déterminer la position des barrières dans les intervalles de l'Homme: 
##Déterminer dans le génome la position des barrières de l'Homme présentes dans les intervalles:
bash Bar_intervals_human
##Déterminer la position de ces barrières au sein des alignements du chimpanzé: 
python3 C_bar_positions.py -inter /home/saraoukkal/Documents/Stage_M1/Human_Step2_results/H_intervals_sorted.bed -bar /home/saraoukkal/Documents/Stage_M1/Human_Step2_results/H_barriers_in_inter_sorted.bed -o /home/saraoukkal/Documents/Stage_M1/Human_Step2_results/new_bar_pos.txt

#Déterminer le pattern mutationnel de l'Homme (cette étude est réalisée après celle du chimpanzé) 
##Copier fichiers fasta dans le dossier de l'Homme: 
bash Move_fasta
##Répérer les différences de nucléotides Homme-Chimp: (inverser séquences H et C) 
python3 Mut_pattern.py -H /home/saraoukkal/Documents/Stage_M1/Human_Step3_results/C_seq.fa -C /home/saraoukkal/Documents/Stage_M1/Human_Step3_results/H_seq.fa -G /home/saraoukkal/Documents/Stage_M1/Human_Step3_results/G_seq.fa -O /home/saraoukkal/Documents/Stage_M1/Human_Step3_results/O_seq.fa -out /home/saraoukkal/Documents/Stage_M1/Human_Step3_results/mut_pattern.txt 

#Définir le pattern mutationnel de l'Homme autour des barrières: 
##Repérer les mutations dont on peut déterminer l'état ancestral: 
###Modifiers pathways du script bash: 
bash Mut_barriers_human
##Compter les mutations par type et par position par rapport aux barrières: 
python3 Mut_pattern_bar.py -bar /home/saraoukkal/Documents/Stage_M1/Human_Step2_results/H_barriers_in_inter_sorted.bed -mut /home/saraoukkal/Documents/Stage_M1/Human_Step4_results/mut_EA_sorted.txt -out /home/saraoukkal/Documents/Stage_M1/Human_Step4_results/mut_count_bar.txt

#Définir les bases non mutées aux bords des barrières du chimpanzé: 
##Déterminer les bases non mutées depuis les séquences des 4 espèces: 
python3 Calcul_ancestralBase.py -H /home/saraoukkal/Documents/Stage_M1/Human_Step3_results/C_seq.fa -C /home/saraoukkal/Documents/Stage_M1/Human_Step3_results/H_seq.fa -G /home/saraoukkal/Documents/Stage_M1/Human_Step3_results/G_seq.fa -O /home/saraoukkal/Documents/Stage_M1/Human_Step3_results/O_seq.fa -out /home/saraoukkal/Documents/Stage_M1/Human_Step4_results/AB_human.txt 
##Trier le fichier de sortie par chromosome et par position: 
sort -k1,1 -k2,2n /home/saraoukkal/Documents/Stage_M1/Human_Step4_results/AB_human.txt  > /home/saraoukkal/Documents/Stage_M1/Human_Step4_results/AB_human_sorted.txt 
##Compter les bases par type et par position par rapport aux barrières:
python3 Ancestral_base_bar_dist.py -bar /home/saraoukkal/Documents/Stage_M1/Human_Step2_results/H_barriers_in_inter_sorted.bed -AB /home/saraoukkal/Documents/Stage_M1/Human_Step4_results/AB_human_sorted.txt  -out /home/saraoukkal/Documents/Stage_M1/Human_Step4_results/AB_count_bar.txt



