
#Récupérer les alignements communs aux 4 espèces: 
##Créer les fichiers .bed de l'Homme:
python3 Human_bed.py -i /media/disk1/soukkal/StageM2/Stage_M1/20200616_hg38_to_panTro5/ -o /media/disk1/soukkal/StageM2/Stage_M1/Step1_results/20200728_HC.bed
python3 Human_bed.py -i /media/disk1/soukkal/StageM2/Stage_M1/20200724_hg38_to_gorGor4/ -o /media/disk1/soukkal/StageM2/Stage_M1/Step1_results/20200728_HG.bed 
python3 Human_bed.py -i /media/disk1/soukkal/StageM2/Stage_M1/20200724_hg38_to_ponAbe2/ -o /media/disk1/soukkal/StageM2/Stage_M1/Step1_results/20200728_HO.bed
##Calculer les intervalles de l'Homme qui s'alignet sur les 4 espèces: 
###J'ai du modifier le script Human_Bedtools_intersect à cause des pathways pour les fichiers (comment utiliser argparse dans un script bash) et changer les noms des outputs 
bash Human_Bedtools_intersect 
##Recalculer les intervalles de toutes les espèces: 
python3 New_intervals.py -sp1 /media/disk1/soukkal/StageM2/Stage_M1/20200616_hg38_to_panTro5/ -sp2 /media/disk1/soukkal/StageM2/Stage_M1/20200724_hg38_to_gorGor4/ -sp3 /media/disk1/soukkal/StageM2/Stage_M1/20200724_hg38_to_ponAbe2/ -bed /media/disk1/soukkal/StageM2/Stage_M1/Step1_results/HC_HG_HO_intersect_sorted.bed -o /media/disk1/soukkal/StageM2/Stage_M1/Step1_results/new_intervals.txt

#Déterminer la position des barrières dans les intervalles de l'Homme: 
##Sélectionner les barrières qui ont un inter barrière de plus de 1000nt: 
python3 select_inter_bar.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Barriers/hg38/20200228_interSmallNFR.dat -o /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/selected_inter_bar.txt
# Trier les couples de barrières par chromosome et par position: 
sort -k1,1 -k2,2n /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/selected_inter_bar.txt > /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/selected_inter_bar_sorted.bed

#Déterminer le pattern mutationnel de l'Homme (cette étude est réalisée après celle du chimpanzé) 
##Copier fichiers fasta dans le dossier de l'Homme: 
bash Move_fasta
##ou télécharger les fichiers fasta: 
bash Get_seq_files

##Définir les bases non mutées aux bords des barrières de l'Homme: 
###Déterminer les bases non mutées depuis les séquences des 4 espèces: 
python3 Calcul_AB_nostr.py -H /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/H_seq.fa -C /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/C_seq.fa -G /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/G_seq.fa -O /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/O_seq.fa -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human2.txt 
###Trier le fichier de sortie par chromosome et par position: 
sort -k1,1 -k2,2n /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human.txt  > /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human_sorted.txt 
##Retirer les CpG des bases ancestrales: 
python3 AB_nonCpG_CpG.py -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human_sorted.txt -nonCpG /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human_nonCpG.txt -CpG /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human_CpG.txt
###Compter les bases ancestrales par type et par position par rapport aux barrières sélectionnées:
python3 AB_bar_dist.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/selected_inter_bar_sorted.bed -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human_sorted.txt  -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_count_bar.txt
###Compter les bases ancestrales par rapport à toutes les barrières: 
python3 AB_bar_dist.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Barriers/hg38/20200228_interSmallNFR.dat -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human_sorted.txt  -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_count_all_bar.txt
###Compter les bases actuelles par type et par position par rapport aux barrières: 
python3 Actual_base_bar_dist.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/selected_inter_bar_sorted.bed -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human_sorted.txt  -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Actual_count_bar.txt

###Repérer les mutations chez l'Homme: 
python3 Calcul_mutations.py -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human_sorted.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Mut_human.txt
###Repérer les mutations CpG et non CpG:
python3 Mut_nonCpG_CpG.py -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_human_sorted.txt -nonCpG /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Mut_human_nonCpG.txt -CpG /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Mut_human_CpG.txt
#Positionner les mutations autour des barrières:
python3 Mut_pattern_bar.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/selected_inter_bar_sorted.bed -mut /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Mut_human.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/mut_count_bar.txt
#Positionner les mutations CpG et non CpG autour des barrières:
python3 Mut_pattern_bar.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/selected_inter_bar_sorted.bed -mut /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Mut_human_nonCpG.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/mut_nonCpG_count_bar.txt

python3 Mut_pattern_bar.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/selected_inter_bar_sorted.bed -mut /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Mut_human_CpG.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/mut_CpG_count_bar.txt

#Calcul du taux de mutations par type de substitutions:
python3 spe_mut_rates.py -mut /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/mut_count_bar.txt -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_count_bar.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Human_mut_rates.txt
#Faire graphiques par type de substitutions: 
python3 mut_rates_plots.py -MR /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Human_mut_rates.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/
#Calcul taux de mutations global/CpG/nonCpG: 
##Tous:
python3 mut_rate.py -mut /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/mut_count_bar.txt -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_count_bar.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Human_mut_rate.txt
##CpG:
python3 mut_rate.py -mut /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/mut_CpG_count_bar.txt -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_count_bar.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Human_CpG_mut_rate.txt
##nonCpG: 
python3 mut_rate.py -mut /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/mut_nonCpG_count_bar.txt -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_count_bar.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Human_nonCpG_mut_rate.txt
#Faire graphique taux de mutations global: 
python3 mut_rate_plot.py -MR /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Human_mut_rate.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/Mut_rate.png
##Non CpG:
python3 mut_rate_plot.py -MR /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Human_nonCpG_mut_rate.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/Mut_rate_nonCpG.png
##CpG:
python3 mut_rate_plot.py -MR /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Human_CpG_mut_rate.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/Mut_rate_CpG.png

#Mesurer GC%, nombre de sites, nombre de chaque base: 
##Bases ancestrales:
python3 plot_sites.py -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_count_bar.txt -out //media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/AB_plots/
##Bases actuelles:
python3 plot_sites.py -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Actual_count_bar.txt -out //media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/Actual_plots/
##Mutations: 
python3 plot_sites.py -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/mut_count_bar.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/Mut_plots/


#Copier les figures de clus7 à la machine locale: (example de chemins)
#A faire sur la machine locale  
scp soukkal@clus7.igfl.ens-lyon.fr:/media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/distri.png /home/saraoukkal/Documents/Stage_M1/Human_Results
scp -r soukkal@clus7.igfl.ens-lyon.fr:/media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/Actual_plots /home/saraoukkal/Documents/Stage_M1/Human_Results

#Distribution de la taille des intervalles alignés sur les 4 espèces: 
python3 Distri_intervals.py -inter /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/H_intervals.bed -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/distri_inter.png

#Distribution de la taille des barrières de l'Homme: 
python3 Distri_intervals.py -inter /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/H_barriers_sorted.bed -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/distri_bar.png

##Calcul de la proportion de barrières de l'Homme inclues dans les intervalles: 
python3 Bar_proportion.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/H_barriers_sorted.bed -bar_inter /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/H_barriers_in_inter_sorted.bed

#Distribution de la taille des barrières de l'Homme inclues dans les intervalles: 
python3 Distri_intervals.py -inter /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/H_barriers_in_inter_sorted.bed -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/distri_bar_in_inter.png

#Compter les CpG: 
python3 CpG.py -H /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/C_seq.fa -C /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/H_seq.fa -G /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/G_seq.fa -O /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/O_seq.fa 

#Analyse du génome entier de l'Homme:
##Convertir fasta en bed: 
python3 Genome_into_bases.py -fa /media/disk1/soukkal/StageM2/Stage_M1/Human_Step3_results/hg38.fa -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/genome_bases.txt
#Positionner bases autour de toutes les barrières: 
python3 Ali_bar_dist.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Barriers/hg38/20200228_interSmallNFR.dat -B /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/genome_bases.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/genome_count_bar.txt
#Positionner bases autour d'interbar de + de 1000:
python3 Ali_bar_dist.py -bar /media/disk1/soukkal/StageM2/Stage_M1/Human_Step2_results/selected_inter_bar_sorted.bed -B /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/genome_bases.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/genome_count_spe_bar.txt
#Metrics: 
python3 plot_sites.py -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/genome_count_bar.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/Genome_plots/

python3 plot_sites.py -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/genome_count_spe_bar.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/Genome_spe_plots/
#Normaliser nombre de sites AB/ nombre de sites dispo autour des NIEBs:
python3 Plot_sites_norm.py -AB /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/AB_count_bar.txt -Gen /media/disk1/soukkal/StageM2/Stage_M1/Human_Step5_results/genome_count_spe_bar.txt -out /media/disk1/soukkal/StageM2/Stage_M1/Human_Step4_results/Plots/AB_norm_plot.png
